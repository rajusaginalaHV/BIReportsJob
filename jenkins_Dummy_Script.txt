pipeline
{
agent any
stages
{
stage('Generate payload')
{
steps
{
  script {
        def Path1=string('/Custom/JenkinsDemo1')
		def Path2=string('/Custom/Interns-23/JenkinsDemo2')
		def Path3=string('/Custom/Raju1/JenkinsDemo2')
          env.USERNAME = input message: 'Please enter the username',
                             parameters: [string(defaultValue: 'lisa.jones',
                                          description: '',
                                          name: 'Username')]
          env.PASSWORD = input message: 'Please enter the password',
                             parameters: [password(defaultValue: '',
                                          description: '',
                                          name: 'Password')]
 	      env.REPORTNAME = input message: 'Please enter the report to be migrated',
                             parameters: [string(defaultValue: 'SampleDM.xdmz',
                                          description: '',
                                          name: 'Reportname')]
	      env.PATHTODEPLOY = input message: 'Please enter the report path',
                             parameters: [string(defaultValue: '/Custom/Demojenkins',
                                          description: '',
                                          name: 'Pathtodeploy')]
		  env.CHOOSE_PATH = input message : 'Please select appropriate path',
		                     parameters: [ string(choice(choices: '$Path1\n$Path2\n$Path3'),
							 description: '',
							 name: 'SELECTED_VALUE')]


                                          bat(returnStdout: true, script: " java EncodeToBase64  ${env.REPORTNAME} Payload.xml ${env.CHOOSE_PATH} ${env.USERNAME} \"${env.PASSWORD}\" ")

        }
   

    
}
}
stage('Move BI object to cataloag server') 
{
steps
{
script{

     

      status_code = bat(returnStdout: true, script: "curl --output output.gzip -w \"%%{http_code}\" --silent --header \"Content-Type:application/xml\" -d @Payload.xml https://fa-erzp-dev12-saasfademo1.ds-fa.oraclepdemos.com:443/xmlpserver/services/v2/CatalogService").trim().split("\n")[1]
                       
      echo "HTTP response status code: ${status_code}"

      if (status_code != "200") {
          error('URL status different of 200. Exiting script.Plese refer output.gzip')
      } 
}


}
}
}
}
